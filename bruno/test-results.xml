<?xml version="1.0"?>
<testsuites>
  <testsuite name="Get Auth Providers" errors="0" failures="0" skipped="0" tests="3" timestamp="2025-07-31T10:56:11.334" hostname="epic.local" time="0.043">
    <testcase name="res.status in [200, 500]" status="pass" classname="http://localhost:8081/api/v1/auth/providers" time="0.014"/>
    <testcase name="Auth providers endpoint is accessible" status="pass" classname="http://localhost:8081/api/v1/auth/providers" time="0.014"/>
    <testcase name="If successful, response contains providers" status="pass" classname="http://localhost:8081/api/v1/auth/providers" time="0.014"/>
  </testsuite>
  <testsuite name="Get MSP Platform Token" errors="0" failures="0" skipped="0" tests="4" timestamp="2025-07-31T10:56:11.335" hostname="epic.local" time="0.109">
    <testcase name="res.status eq 200" status="pass" classname="http://localhost:8083/realms/msp-platform/protocol/openid-connect/token" time="0.027"/>
    <testcase name="res.body.access_token isDefined" status="pass" classname="http://localhost:8083/realms/msp-platform/protocol/openid-connect/token" time="0.027"/>
    <testcase name="Token request returns 200" status="pass" classname="http://localhost:8083/realms/msp-platform/protocol/openid-connect/token" time="0.027"/>
    <testcase name="Response contains access token" status="pass" classname="http://localhost:8083/realms/msp-platform/protocol/openid-connect/token" time="0.027"/>
  </testsuite>
  <testsuite name="Validate Token" errors="0" failures="0" skipped="0" tests="3" timestamp="2025-07-31T10:56:11.335" hostname="epic.local" time="0.006">
    <testcase name="res.status eq 200" status="pass" classname="http://localhost:8081/api/v1/auth/validate" time="0.002"/>
    <testcase name="Token validation returns 200" status="pass" classname="http://localhost:8081/api/v1/auth/validate" time="0.002"/>
    <testcase name="Response indicates valid token" status="pass" classname="http://localhost:8081/api/v1/auth/validate" time="0.002"/>
  </testsuite>
  <testsuite name="Get Tenant Admin Token" errors="0" failures="4" skipped="0" tests="4" timestamp="2025-07-31T10:56:11.335" hostname="epic.local" time="0.048">
    <testcase name="res.status eq 200" status="fail" classname="http://localhost:8083/realms/siem-test/protocol/openid-connect/token" time="0.012">
      <failure type="failure" message="expected 401 to equal 200"/>
    </testcase>
    <testcase name="res.body.access_token isDefined" status="fail" classname="http://localhost:8083/realms/siem-test/protocol/openid-connect/token" time="0.012">
      <failure type="failure" message="expected undefined not to be undefined"/>
    </testcase>
    <testcase name="Tenant token request returns 200" status="fail" classname="http://localhost:8083/realms/siem-test/protocol/openid-connect/token" time="0.012">
      <failure type="failure" message="expected 401 to equal 200"/>
    </testcase>
    <testcase name="Response contains access token" status="fail" classname="http://localhost:8083/realms/siem-test/protocol/openid-connect/token" time="0.012">
      <failure type="failure" message="expected { error: 'invalid_grant', …(1) } to have property 'access_token'"/>
    </testcase>
  </testsuite>
  <testsuite name="Health Check" errors="0" failures="0" skipped="0" tests="5" timestamp="2025-07-31T10:56:11.335" hostname="epic.local" time="0.004">
    <testcase name="res.status eq 200" status="pass" classname="http://localhost:8081/health" time="0.001"/>
    <testcase name="res.body.status eq healthy" status="pass" classname="http://localhost:8081/health" time="0.001"/>
    <testcase name="res.body.service eq booli-admin-api" status="pass" classname="http://localhost:8081/health" time="0.001"/>
    <testcase name="Health endpoint returns 200" status="pass" classname="http://localhost:8081/health" time="0.001"/>
    <testcase name="Response contains service info" status="pass" classname="http://localhost:8081/health" time="0.001"/>
  </testsuite>
  <testsuite name="Test Unauthorized Access" errors="0" failures="0" skipped="0" tests="3" timestamp="2025-07-31T10:56:11.335" hostname="epic.local" time="0.004">
    <testcase name="res.status eq 401" status="pass" classname="http://localhost:8081/api/v1/admin/tenants" time="0.001"/>
    <testcase name="Admin endpoint requires authentication" status="pass" classname="http://localhost:8081/api/v1/admin/tenants" time="0.001"/>
    <testcase name="Returns authentication error" status="pass" classname="http://localhost:8081/api/v1/admin/tenants" time="0.001"/>
  </testsuite>
  <testsuite name="Test Invalid Token" errors="0" failures="0" skipped="0" tests="3" timestamp="2025-07-31T10:56:11.335" hostname="epic.local" time="0.008">
    <testcase name="res.status eq 401" status="pass" classname="http://localhost:8081/api/v1/admin/tenants" time="0.003"/>
    <testcase name="Invalid token returns 401" status="pass" classname="http://localhost:8081/api/v1/admin/tenants" time="0.003"/>
    <testcase name="Returns token validation error" status="pass" classname="http://localhost:8081/api/v1/admin/tenants" time="0.003"/>
  </testsuite>
  <testsuite name="Create Tenant" errors="0" failures="3" skipped="0" tests="3" timestamp="2025-07-31T10:56:11.335" hostname="epic.local" time="0.079">
    <testcase name="res.status eq 201" status="fail" classname="http://localhost:8081/api/v1/admin/tenants" time="0.026">
      <failure type="failure" message="expected 500 to equal 201"/>
    </testcase>
    <testcase name="Tenant creation returns 201" status="fail" classname="http://localhost:8081/api/v1/admin/tenants" time="0.026">
      <failure type="failure" message="expected 500 to equal 201"/>
    </testcase>
    <testcase name="Response contains tenant ID" status="fail" classname="http://localhost:8081/api/v1/admin/tenants" time="0.026">
      <failure type="failure" message="expected { code: 'CREATE_TENANT_FAILED', …(1) } to have property 'id'"/>
    </testcase>
  </testsuite>
  <testsuite name="List Tenants" errors="0" failures="0" skipped="0" tests="4" timestamp="2025-07-31T10:56:11.335" hostname="epic.local" time="0.007">
    <testcase name="res.status eq 200" status="pass" classname="http://localhost:8081/api/v1/admin/tenants" time="0.002"/>
    <testcase name="Tenant list returns 200" status="pass" classname="http://localhost:8081/api/v1/admin/tenants" time="0.002"/>
    <testcase name="Response contains tenant array" status="pass" classname="http://localhost:8081/api/v1/admin/tenants" time="0.002"/>
    <testcase name="Pagination info included" status="pass" classname="http://localhost:8081/api/v1/admin/tenants" time="0.002"/>
  </testsuite>
  <testsuite name="Create User" errors="0" failures="3" skipped="0" tests="3" timestamp="2025-07-31T10:56:11.335" hostname="epic.local" time="0.005">
    <testcase name="res.status eq 201" status="fail" classname="http://localhost:8081/api/v1/admin/users" time="0.002">
      <failure type="failure" message="expected 400 to equal 201"/>
    </testcase>
    <testcase name="User creation returns 201" status="fail" classname="http://localhost:8081/api/v1/admin/users" time="0.002">
      <failure type="failure" message="expected 400 to equal 201"/>
    </testcase>
    <testcase name="Response contains user data" status="fail" classname="http://localhost:8081/api/v1/admin/users" time="0.002">
      <failure type="failure" message="expected { …(2) } to have property 'id'"/>
    </testcase>
  </testsuite>
  <testsuite name="Delete User" errors="0" failures="0" skipped="0" tests="3" timestamp="2025-07-31T10:56:11.335" hostname="epic.local" time="0.004">
    <testcase name="res.status in [200, 204, 404]" status="pass" classname="http://localhost:8081/api/v1/admin/users/" time="0.001"/>
    <testcase name="User deletion returns expected status" status="pass" classname="http://localhost:8081/api/v1/admin/users/" time="0.001"/>
    <testcase name="If successful, user is removed" status="pass" classname="http://localhost:8081/api/v1/admin/users/" time="0.001"/>
  </testsuite>
  <testsuite name="Delete Tenant" errors="0" failures="0" skipped="0" tests="3" timestamp="2025-07-31T10:56:11.335" hostname="epic.local" time="0.005">
    <testcase name="res.status in [200, 204, 404]" status="pass" classname="http://localhost:8081/api/v1/admin/tenants/" time="0.002"/>
    <testcase name="Tenant deletion returns expected status" status="pass" classname="http://localhost:8081/api/v1/admin/tenants/" time="0.002"/>
    <testcase name="If successful, tenant is removed" status="pass" classname="http://localhost:8081/api/v1/admin/tenants/" time="0.002"/>
  </testsuite>
  <testsuite name="Create Environment" errors="1" failures="0" skipped="0" tests="1" timestamp="2025-07-31T10:56:11.335" hostname="epic.local" time="0.006">
    <testcase name="Test suite has no errors" status="fail" classname="http://{{base_url}}/api/v1/environments" time="0.006">
      <error type="error" message="getaddrinfo ENOTFOUND {{base_url}}"/>
    </testcase>
  </testsuite>
  <testsuite name="Get Environment" errors="1" failures="0" skipped="0" tests="1" timestamp="2025-07-31T10:56:11.335" hostname="epic.local" time="0.003">
    <testcase name="Test suite has no errors" status="fail" classname="http://{{base_url}}/api/v1/environments/{{environment_id}}" time="0.003">
      <error type="error" message="getaddrinfo ENOTFOUND {{base_url}}"/>
    </testcase>
  </testsuite>
  <testsuite name="List Environments" errors="1" failures="0" skipped="0" tests="1" timestamp="2025-07-31T10:56:11.335" hostname="epic.local" time="0.002">
    <testcase name="Test suite has no errors" status="fail" classname="http://{{base_url}}/api/v1/environments?page=1&amp;page_size=10" time="0.002">
      <error type="error" message="getaddrinfo ENOTFOUND {{base_url}}"/>
    </testcase>
  </testsuite>
  <testsuite name="Update Environment" errors="1" failures="0" skipped="0" tests="1" timestamp="2025-07-31T10:56:11.335" hostname="epic.local" time="0.003">
    <testcase name="Test suite has no errors" status="fail" classname="http://{{base_url}}/api/v1/environments/{{environment_id}}" time="0.003">
      <error type="error" message="getaddrinfo ENOTFOUND {{base_url}}"/>
    </testcase>
  </testsuite>
  <testsuite name="Get SIEM Enrichment Data" errors="1" failures="0" skipped="0" tests="1" timestamp="2025-07-31T10:56:11.335" hostname="epic.local" time="0.003">
    <testcase name="Test suite has no errors" status="fail" classname="http://{{base_url}}/api/v1/environments/enrichment" time="0.003">
      <error type="error" message="getaddrinfo ENOTFOUND {{base_url}}"/>
    </testcase>
  </testsuite>
  <testsuite name="Get Network Ranges" errors="1" failures="0" skipped="0" tests="1" timestamp="2025-07-31T10:56:11.335" hostname="epic.local" time="0.003">
    <testcase name="Test suite has no errors" status="fail" classname="http://{{base_url}}/api/v1/environments/networks" time="0.003">
      <error type="error" message="getaddrinfo ENOTFOUND {{base_url}}"/>
    </testcase>
  </testsuite>
  <testsuite name="Get Infrastructure IPs" errors="1" failures="0" skipped="0" tests="1" timestamp="2025-07-31T10:56:11.335" hostname="epic.local" time="0.003">
    <testcase name="Test suite has no errors" status="fail" classname="http://{{base_url}}/api/v1/environments/ips" time="0.003">
      <error type="error" message="getaddrinfo ENOTFOUND {{base_url}}"/>
    </testcase>
  </testsuite>
  <testsuite name="Lookup Enrichment Data" errors="1" failures="0" skipped="0" tests="1" timestamp="2025-07-31T10:56:11.335" hostname="epic.local" time="0.003">
    <testcase name="Test suite has no errors" status="fail" classname="http://{{base_url}}/api/v1/environments/lookup?ip=203.0.113.1" time="0.003">
      <error type="error" message="getaddrinfo ENOTFOUND {{base_url}}"/>
    </testcase>
  </testsuite>
  <testsuite name="Lookup Domain" errors="1" failures="0" skipped="0" tests="1" timestamp="2025-07-31T10:56:11.335" hostname="epic.local" time="0.003">
    <testcase name="Test suite has no errors" status="fail" classname="http://{{base_url}}/api/v1/environments/lookup?domain=example.com" time="0.003">
      <error type="error" message="getaddrinfo ENOTFOUND {{base_url}}"/>
    </testcase>
  </testsuite>
  <testsuite name="Delete Environment" errors="1" failures="0" skipped="0" tests="1" timestamp="2025-07-31T10:56:11.335" hostname="epic.local" time="0.003">
    <testcase name="Test suite has no errors" status="fail" classname="http://{{base_url}}/api/v1/environments/{{environment_id}}" time="0.003">
      <error type="error" message="getaddrinfo ENOTFOUND {{base_url}}"/>
    </testcase>
  </testsuite>
  <testsuite name="Environment Validation Tests" errors="1" failures="0" skipped="0" tests="1" timestamp="2025-07-31T10:56:11.335" hostname="epic.local" time="0.003">
    <testcase name="Test suite has no errors" status="fail" classname="http://{{base_url}}/api/v1/environments" time="0.003">
      <error type="error" message="getaddrinfo ENOTFOUND {{base_url}}"/>
    </testcase>
  </testsuite>
  <testsuite name="Create Environment" errors="0" failures="1" skipped="0" tests="1" timestamp="2025-07-31T10:56:11.335" hostname="epic.local" time="0.004">
    <testcase name="should create environment successfully" status="fail" classname="http://localhost:8081/api/v1/environments" time="0.004">
      <failure type="failure" message="expected 401 to equal 201"/>
    </testcase>
  </testsuite>
  <testsuite name="List Environments" errors="0" failures="1" skipped="0" tests="1" timestamp="2025-07-31T10:56:11.335" hostname="epic.local" time="0.003">
    <testcase name="should list environments successfully" status="fail" classname="http://localhost:8081/api/v1/environments?page=1&amp;pageSize=10" time="0.003">
      <failure type="failure" message="expected 401 to equal 200"/>
    </testcase>
  </testsuite>
  <testsuite name="Get Environment" errors="0" failures="1" skipped="0" tests="1" timestamp="2025-07-31T10:56:11.335" hostname="epic.local" time="0.005">
    <testcase name="should get environment successfully" status="fail" classname="http://localhost:8081/api/v1/environments/" time="0.005">
      <failure type="failure" message="expected 401 to equal 200"/>
    </testcase>
  </testsuite>
  <testsuite name="Update Environment" errors="0" failures="1" skipped="0" tests="1" timestamp="2025-07-31T10:56:11.335" hostname="epic.local" time="0.003">
    <testcase name="should update environment successfully" status="fail" classname="http://localhost:8081/api/v1/environments/" time="0.003">
      <failure type="failure" message="expected 404 to equal 200"/>
    </testcase>
  </testsuite>
  <testsuite name="Get SIEM Enrichment Data" errors="0" failures="1" skipped="0" tests="1" timestamp="2025-07-31T10:56:11.335" hostname="epic.local" time="0.003">
    <testcase name="should get SIEM enrichment data successfully" status="fail" classname="http://localhost:8081/api/v1/environments/enrichment" time="0.003">
      <failure type="failure" message="expected 401 to equal 200"/>
    </testcase>
  </testsuite>
  <testsuite name="Delete Environment" errors="0" failures="1" skipped="0" tests="1" timestamp="2025-07-31T10:56:11.335" hostname="epic.local" time="0.003">
    <testcase name="should delete environment successfully" status="fail" classname="http://localhost:8081/api/v1/environments/" time="0.003">
      <failure type="failure" message="expected 404 to equal 204"/>
    </testcase>
  </testsuite>
  <testsuite name="Environment Validation Tests" errors="0" failures="1" skipped="0" tests="1" timestamp="2025-07-31T10:56:11.335" hostname="epic.local" time="0.004">
    <testcase name="should reject environment with empty name" status="fail" classname="http://localhost:8081/api/v1/environments" time="0.004">
      <failure type="failure" message="expected 401 to be one of [ 400, 500 ]"/>
    </testcase>
  </testsuite>
</testsuites>